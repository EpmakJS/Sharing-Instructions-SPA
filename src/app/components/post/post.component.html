<div class="container">
  <div class="row">
    <h1 class="col-sm-12">Post a Tutorial</h1>
  </div>

  <form [formGroup]="postForm" (ngSubmit)="addPost(postForm.value)">

    <div class="row">
      <div class="col-sm-12 col-md-6">
        <label>
          Title of Tutorial:
          <input type="text" name="title" [formControl]="postForm.controls['title']">
        </label>
        <div class="alert" *ngIf="!postForm.controls['title'].valid && postForm.controls['title'].touched">You must specify a title that's between 15 and 70 characters long.</div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-6">
        <label>
          Description of Tutorial:
          <textarea name="description" id="description" [formControl]="postForm.controls['description']"></textarea>
        </label>
        <div class="alert" *ngIf="!postForm.controls['description'].valid && postForm.controls['description'].touched">You must specify a description that's between 100 and 500 characters long.</div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-6">
        <label>
          Image of Tutorial:
          <input type="text" name="image" id="image" [formControl]="postForm.controls['image']">
        </label>
        <div class="alert" *ngIf="!postForm.controls['image'].valid && postForm.controls['image'].touched">You must add image.</div>
      </div>
    </div>

    <div class="row">
        <div class="col-sm-12 col-md-6">
          <h3>Steps</h3>
          <button type="button" class="add-step" (click)="addStep()">
            <i class="fas fa-plus"></i>
          </button>
          <div formArrayName="steps">
            <div *ngFor="let step of postForm.controls['steps'].controls; let i = index">
              <div class="step-box" formGroupName="{{i}}">
                <label>
                  Step title:
                  <input type="text" name="head" [formControl]="postForm.controls.steps.controls['head']">
                </label>
                <div class="alert" *ngIf="!postForm.controls.steps.controls['head'].valid && postForm.controls.steps.controls['head'].touched">You must specify a step title that's between 15 and 70 characters long.</div>

                <label>
                  Step description:
                  <textarea name="body" id="body" [formControl]="postForm.controls.steps.controls['body']"></textarea>
                </label>
                <div class="alert" *ngIf="!postForm.controls.steps.controls['body'].valid && postForm.controls.steps.controls['body'].touched">You must specify a step description that's between 100 and 500 characters long.</div>

                <h4 class="images"> Images </h4> 
                <button type="button" class="add-image" (click)="addImage(i)">
                  <i class="fas fa-plus"></i>
                </button>
                <div class="img-group" formArrayName="img">
                  <div *ngFor="let image of step.controls['img'].controls; let j = index">
                    <div class="image-box" formGroupName="{{j}}">
                      <label>
                        Place image source:
                        <input type="text" [formControl]="postForm.controls.steps.controls.img.controls.src">
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <button class="btn btn-outline-primary" tabindex="0" (click)="addStep()">
                Add Step
              </button>
            </div>
          </div>
        </div>
      </div>
    <div class="row">
      <div class="col-sm-12">
        <input type="submit" class="btn btn-outline-primary" value="Post Tutorial" [disabled]="!postForm.valid">
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12">
        <h3>Form Value: {{postForm.value | json}}</h3>
      </div>
    </div>
  </form>
</div>
